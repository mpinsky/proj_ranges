Methods for Sediment Grain Size Assignment





Step 1: Create lookup table of grain size (phi), and percentages of gravel, sand and mud for all sediment types listed in raw datasets.

A) Combine all usSEABED extracted datasets (atl_ext, pac_ext, gmx_ext) and use point data to calculate mean GRAINSIZE (phi), GRAVEL, SAND, MUD for each FOLKCODE. These folkcodes are used to infer values for the Gulf of Alaska, Aleutian Islands, and Grand Banks where sediments were described verbally. Table saved as "folk_usSEABED_perc_phi.rds"
Source: https://walrus.wr.usgs.gov/usseabed/data.html

B) Infer phi values for pure gravel, sand or mud from this table by estimating grain size based on multiplying values for G, S, and M with their percentages and minimizing the difference between GRAINSIZE in table and this estimated value. The resulting values are G= -2.7, S=1.7, M=7.5. Since the Gulf of Mexico reported percentages of gravel, sand and mud but not grain size, use these values to assign GRAINSIZE to each polygon
Source: https://www.ncddc.noaa.gov/website/DataAtlas/Metadata/ISO/usSEABED_GOM_sediments.html

C) For the US Atlantic Shelf, extracted values from the CONMAP polygons for point samples in the East Coast Sediment Texture database (ecstdb2005). Calculated the mean GRAINSIZE from "MEAN", GRAVEL from GRAVEL_PCT, SAND from SAND_PCT, and MUD from the sum of SILT_PCT and CLAY_PCT for each SEDIMENT and SEDNUM in CONMAP. These values were assigned as the values for each polygon in CONMAP.
Sources: 
## https://catalog.data.gov/dataset/conmapsg-continental-margin-mapping-program-conmap-sediments-grainsize-distribution-for-the-uni
## http://pubs.usgs.gov/of/2005/1001/data/surficial_sediments/ecstdb2005.zip


Step 2: Classify habitat at haul locations
US Atlantic Shelf (including western-most hauls in Scotian Shelf Spring survey)
Match haul locations with the sediment data for each CONMAP polygon.
Sources: 
## https://catalog.data.gov/dataset/conmapsg-continental-margin-mapping-program-conmap-sediments-grainsize-distribution-for-the-uni

Gulf of Mexico
Match haul locations to sediment data in each usSEABED polygon
Source: https://www.ncddc.noaa.gov/website/DataAtlas/Metadata/ISO/usSEABED_GOM_sediments.html

US West Coast
Use inverse distance weighting interpolation of usSEABED parsed data for the Pacific Coast. Used gstat package function idw in R (with default idp=2) 

Alaska
A) Assigning sediment characteristics to point data
Gulf of Alaska 
Assigned grain size, and sediment percentages to point data from Gulf of Alaska Digitization Project based on verbal description of sediments
See "goa.sed.codes.complete.csv"
Source: https://www.sciencebase.gov/catalog/item/5699855be4b0ec051295ed8b

Aleutian Islands
Assigned grain size, and sediment percentages based on verbal descriptions of sediments from shapefile of sediment point data from AFSC
Source: http://www.afsc.noaa.gov/RACE/groundfish/Bathymetry/Aleutians.htm

Eastern Bering Sea
Used recorded grain size, and sediment percentages from EBSSED database
Source: https://data.noaa.gov/dataset/ebssed-database-surficial-sediments-of-the-eastern-bering-sea-continental-shelf

B) Combine all three AK regions into a single dataframe. Use inverse distance weighting interpolation using gstat package with function idw with defualt idp=2

Canada
A) Inverse distance weighting interpolation from point data
Scotian Shelf
Restrict to hauls conducted by DFO_Scotian Shelf
Use GRAINSIZE (=Mean), GRAVEL (=X.Gravel),  SAND (=X.Sand), and MUD (=X.Mud) from samples in the Natural Resources Canada Expedition Database 
Source: http://ed.gdr.nrcan.gc.ca/grainsize_e.php

Labrador
Restrict hauls to those within the DFO_Newfoundland surveys AND with latitude >52 
Use GRAINSIZE (=Mean), GRAVEL (=X.Gravel),  SAND (=X.Sand), and MUD (=X.Mud) from samples in the Natural Resources Canada Expedition Database.
Source: http://ed.gdr.nrcan.gc.ca/grainsize_e.php

B) Extract data from polygons
Grand Banks of Newfoundland
Infer sediment type from verbal description of dominant sediment in Quaternary unconsolidated sediment thickness on the Grand Banks of Newfoundland and northeast Newfoundland Shelf; a GIS database
http://geogratis.gc.ca/api/en/nrcan-rncan/ess-sst/97fc16ab-aadc-52f5-b33a-9145a78dd21c.html

Match with GRAINSIZE and percentage of sediment types with "folk_usSEABED_perc_phi.rds" table

Extract sediment values from polygons for haul locations.

Also use idw for areas of the southern part of Newfoundland study region that were not included within the extent of the sediment thickness database. However, may make more sense to just exclude these for the purpose of fitting the species distribution model. The two outputs are saved separately as "hauls.newf.poly.rds" to refer the polygon extraction and "haul_sp/hauls.newf.idw.rds" for the inverse distance weighting interpolation.


Step 3: Combine all sediment data into a single dataframe
Scotian Shelf Spring had some hauls within the extent of the CONMAP polygons as well as the Expedition  point samples. 1858 hauls are duplicated in the sediment.all datatable. I've retained both to allow choice of which method is preferred (poly.extract or idw)

Results in sediment grain information for ~140K hauls (from 148K original set of hauls)

Output: 
GRAINSIZE: estimate of grain size (units=phi)
GRAVEL: estimate of percentage of the sediments composed of gravel
SAND: estimate of percentage of sediments composed of sand
MUD: estimate of percentage of sediments composed of mud
method: how the sediment data was calculated, either extracting for a polygon shapefile (=extract.poly), or inverse distance weighting interpolation (=idw)





